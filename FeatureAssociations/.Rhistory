##--draw plot for
library(ggplot2)
library(latex2exp)
setwd('F:/Bladder_project/FeatureAssociations')
##-load data
feature_table = read.csv('F:/Bladder_project//ct_wsi_merged_features.csv', header = TRUE, sep = ',', row.names = 1)
##--load the block 1 data
cluster = read.csv('./output/halla_cluster1_asso.csv', header = TRUE, sep = ',')
feature_names = unique(c(cluster$X_features, cluster$Y_features))
input_table = feature_table[,c('Mean_nuclei_Texture_Correlation_Hematoxylin_3_00_256',"cancer_firstorder_TotalEnergy")]
##--draw plot for
library(ggplot2)
library(latex2exp)
setwd('F:/Bladder_project/FeatureAssociations')
setwd('G:/Bladder_project/FeatureAssociations')
##-load data
feature_table = read.csv('G:/Bladder_project//ct_wsi_merged_features.csv', header = TRUE, sep = ',', row.names = 1)
##--load the block 1 data
cluster = read.csv('./output/halla_cluster1_asso.csv', header = TRUE, sep = ',')
feature_names = unique(c(cluster$X_features, cluster$Y_features))
input_table = feature_table[,c('Mean_nuclei_Texture_Correlation_Hematoxylin_3_00_256',"cancer_firstorder_TotalEnergy")]
colnames(input_table) = c('nuclei_mean_Texture_CORH3', 'cancer_firstorder_TE')
input_table$cancer_firstorder_TE = log10(input_table$cancer_firstorder_TE)
corRes = cor.test(input_table[,1], input_table[,2])
p.value = corRes$p.value
cor = round(corRes$estimate,3)
confint = round(corRes$conf.int, 3)- cor
anno_text1 = TeX('$R = 0.537\\pm$0.113')
anno_text2 = 'P < 0.001'
rect = data.frame(x = c(0.33,0.33,0.53,0.53),
y = c(8.6,9.3,9.3,8.6))
corRes
